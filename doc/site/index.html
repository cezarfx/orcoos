<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Oracle NoSQL Database Orcoos SDK - v0.0.1</title><meta name="description" content="Documentation for Oracle NoSQL Database Orcoos SDK"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">Oracle NoSQL Database Orcoos SDK - v0.0.1</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>Oracle NoSQL Database Orcoos SDK - v0.0.1</h2></div><div class="tsd-panel tsd-typography"><a id="md:orcoos" class="tsd-anchor"></a><h1><a href="#md:orcoos">Orcoos</a></h1><p>Orcoos is a <a href="https://www.oracle.com/database/nosql/">Oracle NoSQL DB</a> object modeling tool designed to work in an asynchronous environment. Orcoos supports <a href="https://nodejs.org/en/">Node.js</a>. Orcoos is modeled after <a href="https://mongoosejs.com/">Mongoose</a>.</p>
<a id="md:documentation" class="tsd-anchor"></a><h2><a href="#md:documentation">Documentation</a></h2><p>The official documentation website is <a href="http://github.com/">TBD</a>.</p>
<a id="md:dev-instalation" class="tsd-anchor"></a><h2><a href="#md:dev-instalation">Dev instalation</a></h2><p>Clone from GitHub (requires git):
$ git clone <a href="https://github.com/cezarfx/orcoos.git">https://github.com/cezarfx/orcoos.git</a>
$ cd orcoos</p>
<p>Install dependencies (requires NodeJS &gt; 18 and npm &gt; 10.3):
$ npm install</p>
<p>Run tests, must have a Oracle NoSQL DB instance (kvlite and proxy) running on <a href="http://localhost:8080">http://localhost:8080</a>:
$ npm test</p>
<p>Run a single test:
$ node ./node_modules/mocha/bin/mocha.js --require ts-node/register test/main.test.ts</p>
<p>Localy link the Orcoos npm package:
$ npm link</p>
<p>Run examples, must have a Oracle NoSQL DB instance (kvlite and proxy) running on <a href="http://localhost:8080">http://localhost:8080</a>:
$ cd examples/typescript
$ npm link orcoos
$ npm start</p>
<p>$ cd ../javascript
$ npm link orcoos
$ npm start</p>
<p>Or run them all, tests and examples:
$ cd ../..
$ npm run all</p>
<a id="md:installation" class="tsd-anchor"></a><h2><a href="#md:installation">Installation</a></h2><p>First install <a href="http://nodejs.org/">Node.js</a> and <a href="https://www.oracle.com/database/technologies/nosql-database-server-downloads.html">Oracle NoSQL DB</a>. Then:</p>
<pre><code class="language-sh"><span class="hl-0">$</span><span class="hl-1"> </span><span class="hl-2">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">orcoos</span>
</code><button>Copy</button></pre>
<p>Note: For examples in the ./examples dir to work npm link must be used. See <a href="https://docs.npmjs.com/cli/v8/commands/npm-link">https://docs.npmjs.com/cli/v8/commands/npm-link</a> .</p>
<a id="md:importing" class="tsd-anchor"></a><h2><a href="#md:importing">Importing</a></h2><pre><code class="language-javascript"><span class="hl-3">// Using Node.js `require()`</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">orcoose</span><span class="hl-1"> = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&#39;orcoos&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-3">// Using ES6 imports</span><br/><span class="hl-6">import</span><span class="hl-1"> </span><span class="hl-7">orcoos</span><span class="hl-1"> </span><span class="hl-6">from</span><span class="hl-1"> </span><span class="hl-2">&#39;orcoos&#39;</span><span class="hl-1">;</span>
</code><button>Copy</button></pre>
<a id="md:overview" class="tsd-anchor"></a><h2><a href="#md:overview">Overview</a></h2><a id="md:connecting-to-oracle-nosql-db" class="tsd-anchor"></a><h3><a href="#md:connecting-to-oracle-nosql-db">Connecting to Oracle NoSQL DB</a></h3><p>First, we need to define a connection. If your app uses only one database, you should use <code>orcoos.connect</code>. If you need to create additional connections, use <code>orcoos.createConnection</code>.</p>
<p>Both <code>connect</code> and <code>createConnection</code> take a connection string <code>nosqldb://</code> URI.</p>
<pre><code class="language-js"><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-7">orcoos</span><span class="hl-1">.</span><span class="hl-0">connect</span><span class="hl-1">(</span><span class="hl-2">&#39;nosqldb+on_prem_http://127.0.0.1:8080/&#39;</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<p>Once connected, the <code>open</code> event is fired on the <code>Connection</code> instance. If you&#39;re using <code>orcoos.connect</code>, the <code>Connection</code> is <code>orcoos.connection</code>. Otherwise, <code>orcoos.createConnection</code> return value is a <code>Connection</code>.</p>
<p><strong>Note:</strong> <em>If the local connection fails then try using 127.0.0.1 instead of localhost. Sometimes issues may arise when the local hostname has been changed.</em></p>
<p><strong>Important!</strong> Orcoos buffers all the commands until it&#39;s connected to the database. This means that you don&#39;t have to wait until it connects to Oracle NoSQL DB in order to define models, run queries, etc.</p>
<a id="md:defining-a-model" class="tsd-anchor"></a><h3><a href="#md:defining-a-model">Defining a Model</a></h3><p>Models are defined through the <code>Schema</code> interface.</p>
<pre><code class="language-js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">Schema</span><span class="hl-1"> = </span><span class="hl-7">orcoos</span><span class="hl-1">.</span><span class="hl-7">Schema</span><span class="hl-1">;</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">ObjectId</span><span class="hl-1"> = </span><span class="hl-7">Schema</span><span class="hl-1">.</span><span class="hl-7">ObjectId</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">BlogPost</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">Schema</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-7">author:</span><span class="hl-1"> </span><span class="hl-7">ObjectId</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">title:</span><span class="hl-1"> </span><span class="hl-7">String</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-7">body:</span><span class="hl-1"> </span><span class="hl-7">String</span><span class="hl-1">,</span><br/><span class="hl-1">Â  </span><span class="hl-7">date:</span><span class="hl-1"> </span><span class="hl-7">Date</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<p>Aside from defining the structure of your documents and the types of data you&#39;re storing, a Schema handles the definition of:</p>
<ul>
<li><a href="http://mongoosejs.com/docs/validation.html">Validators</a> (async and sync)</li>
<li><a href="http://mongoosejs.com/docs/api/schematype.html#schematype_SchemaType-default">Defaults</a></li>
<li><a href="http://mongoosejs.com/docs/api/schematype.html#schematype_SchemaType-get">Getters</a></li>
<li><a href="http://mongoosejs.com/docs/api/schematype.html#schematype_SchemaType-set">Setters</a></li>
<li><a href="http://mongoosejs.com/docs/guide.html#indexes">Indexes</a></li>
<li><a href="http://mongoosejs.com/docs/middleware.html">Middleware</a></li>
<li><a href="http://mongoosejs.com/docs/guide.html#methods">Methods</a> definition</li>
<li><a href="http://mongoosejs.com/docs/guide.html#statics">Statics</a> definition</li>
<li><a href="http://mongoosejs.com/docs/plugins.html">Plugins</a></li>
<li><a href="http://mongoosejs.com/docs/populate.html">pseudo-JOINs</a></li>
</ul>
<p>The following example shows some of these features:</p>
<pre><code class="language-js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">Comment</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">Schema</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-7">name:</span><span class="hl-1"> { </span><span class="hl-7">type:</span><span class="hl-1"> </span><span class="hl-7">String</span><span class="hl-1">, </span><span class="hl-7">default:</span><span class="hl-1"> </span><span class="hl-2">&#39;hahaha&#39;</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-7">age:</span><span class="hl-1"> { </span><span class="hl-7">type:</span><span class="hl-1"> </span><span class="hl-7">Number</span><span class="hl-1">, </span><span class="hl-7">min:</span><span class="hl-1"> </span><span class="hl-8">18</span><span class="hl-1">, </span><span class="hl-7">index:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-7">bio:</span><span class="hl-1"> { </span><span class="hl-7">type:</span><span class="hl-1"> </span><span class="hl-7">String</span><span class="hl-1">, </span><span class="hl-7">match:</span><span class="hl-9"> /</span><span class="hl-10">[</span><span class="hl-9">a-z</span><span class="hl-10">]</span><span class="hl-9">/</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-7">date:</span><span class="hl-1"> { </span><span class="hl-7">type:</span><span class="hl-1"> </span><span class="hl-7">Date</span><span class="hl-1">, </span><span class="hl-7">default:</span><span class="hl-1"> </span><span class="hl-7">Date</span><span class="hl-1">.</span><span class="hl-7">now</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-7">buff:</span><span class="hl-1"> </span><span class="hl-7">Buffer</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-3">// a setter</span><br/><span class="hl-7">Comment</span><span class="hl-1">.</span><span class="hl-0">path</span><span class="hl-1">(</span><span class="hl-2">&#39;name&#39;</span><span class="hl-1">).</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-4">function</span><span class="hl-1"> (</span><span class="hl-7">v</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-6">return</span><span class="hl-1"> </span><span class="hl-0">capitalize</span><span class="hl-1">(</span><span class="hl-7">v</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-3">// middleware</span><br/><span class="hl-7">Comment</span><span class="hl-1">.</span><span class="hl-0">pre</span><span class="hl-1">(</span><span class="hl-2">&#39;save&#39;</span><span class="hl-1">, </span><span class="hl-4">function</span><span class="hl-1"> (</span><span class="hl-7">next</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-0">notify</span><span class="hl-1">(</span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;email&#39;</span><span class="hl-1">));</span><br/><span class="hl-1">  </span><span class="hl-0">next</span><span class="hl-1">();</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<p>Take a look at the <a href="./examples/typescript/demo-orcoos.ts"><code>example</code></a> for an a detailed usage.</p>
<a id="md:accessing-a-model" class="tsd-anchor"></a><h3><a href="#md:accessing-a-model">Accessing a Model</a></h3><p>Once we define a model through <code>orcoos.model(&#39;ModelName&#39;, mySchema)</code>, we can access it through the same function</p>
<pre><code class="language-js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">MyModel</span><span class="hl-1"> = </span><span class="hl-7">orcoos</span><span class="hl-1">.</span><span class="hl-0">model</span><span class="hl-1">(</span><span class="hl-2">&#39;ModelName&#39;</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<p>Or just do it all at once</p>
<pre><code class="language-js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">MyModel</span><span class="hl-1"> = </span><span class="hl-7">orcoos</span><span class="hl-1">.</span><span class="hl-0">model</span><span class="hl-1">(</span><span class="hl-2">&#39;ModelName&#39;</span><span class="hl-1">, </span><span class="hl-7">mySchema</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<p>The first argument is the <em>singular</em> name of the collection your model is for. <strong>Orcoos automatically looks for the <em>plural</em> version of your model name.</strong> For example, if you use</p>
<pre><code class="language-js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">MyModel</span><span class="hl-1"> = </span><span class="hl-7">orcoos</span><span class="hl-1">.</span><span class="hl-0">model</span><span class="hl-1">(</span><span class="hl-2">&#39;Ticket&#39;</span><span class="hl-1">, </span><span class="hl-7">mySchema</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<p>Then <code>MyModel</code> will use the <strong>tickets</strong> collection, not the <strong>ticket</strong> collection. For more details read the <a href="https://mongoosejs.com/docs/api/mongoose.html#mongoose_Mongoose-model">model docs</a>.</p>
<p>Once we have our model, we can then instantiate it, and save it:</p>
<pre><code class="language-js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">instance</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">MyModel</span><span class="hl-1">();</span><br/><span class="hl-7">instance</span><span class="hl-1">.</span><span class="hl-7">my</span><span class="hl-1">.</span><span class="hl-7">key</span><span class="hl-1"> = </span><span class="hl-2">&#39;hello&#39;</span><span class="hl-1">;</span><br/><span class="hl-7">instance</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">(</span><span class="hl-4">function</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">//</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<p>Or we can find documents from the same collection</p>
<pre><code class="language-js"><span class="hl-7">MyModel</span><span class="hl-1">.</span><span class="hl-0">find</span><span class="hl-1">({}, </span><span class="hl-4">function</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">, </span><span class="hl-7">docs</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">// docs.forEach</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<p>You can also <code>findOne</code>, <code>findById</code>, <code>update</code>, etc.</p>
<pre><code class="language-js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">instance</span><span class="hl-1"> = </span><span class="hl-6">await</span><span class="hl-1"> </span><span class="hl-7">MyModel</span><span class="hl-1">.</span><span class="hl-0">findOne</span><span class="hl-1">({ ... });</span><br/><span class="hl-7">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-7">instance</span><span class="hl-1">.</span><span class="hl-7">my</span><span class="hl-1">.</span><span class="hl-7">key</span><span class="hl-1">);  </span><span class="hl-3">// &#39;hello&#39;</span>
</code><button>Copy</button></pre>
<p>For more details check out <a href="http://mongoosejs.com/docs/queries.html">the docs</a>.</p>
<p><strong>Important!</strong> If you opened a separate connection using <code>orcoos.createConnection()</code> but attempt to access the model through <code>orcoos.model(&#39;ModelName&#39;)</code> it will not work as expected since it is not hooked up to an active db connection. In this case access your model through the connection you created:</p>
<pre><code class="language-js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">conn</span><span class="hl-1"> = </span><span class="hl-7">orcoos</span><span class="hl-1">.</span><span class="hl-0">createConnection</span><span class="hl-1">(</span><span class="hl-2">&#39;your connection string&#39;</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">MyModel</span><span class="hl-1"> = </span><span class="hl-7">conn</span><span class="hl-1">.</span><span class="hl-0">model</span><span class="hl-1">(</span><span class="hl-2">&#39;ModelName&#39;</span><span class="hl-1">, </span><span class="hl-7">schema</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">m</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-7">MyModel</span><span class="hl-1">;</span><br/><span class="hl-7">m</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">(); </span><span class="hl-3">// works</span>
</code><button>Copy</button></pre>
<p>vs</p>
<pre><code class="language-js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">conn</span><span class="hl-1"> = </span><span class="hl-7">orcoos</span><span class="hl-1">.</span><span class="hl-0">createConnection</span><span class="hl-1">(</span><span class="hl-2">&#39;your connection string&#39;</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">MyModel</span><span class="hl-1"> = </span><span class="hl-7">orcoos</span><span class="hl-1">.</span><span class="hl-0">model</span><span class="hl-1">(</span><span class="hl-2">&#39;ModelName&#39;</span><span class="hl-1">, </span><span class="hl-7">schema</span><span class="hl-1">);</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">m</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-7">MyModel</span><span class="hl-1">;</span><br/><span class="hl-7">m</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">(); </span><span class="hl-3">// does not work b/c the default connection object was never connected</span>
</code><button>Copy</button></pre>
<a id="md:embedded-documents" class="tsd-anchor"></a><h3><a href="#md:embedded-documents">Embedded Documents</a></h3><p>In the first example snippet, we defined a key in the Schema that looks like:</p>
<pre><code><span class="hl-11">comments</span><span class="hl-1">: [</span><span class="hl-7">Comment</span><span class="hl-1">]</span>
</code><button>Copy</button></pre>
<p>Where <code>Comment</code> is a <code>Schema</code> we created. This means that creating embedded documents is as simple as:</p>
<pre><code class="language-js"><span class="hl-3">// retrieve my model</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">BlogPost</span><span class="hl-1"> = </span><span class="hl-7">orcoos</span><span class="hl-1">.</span><span class="hl-0">model</span><span class="hl-1">(</span><span class="hl-2">&#39;BlogPost&#39;</span><span class="hl-1">);</span><br/><br/><span class="hl-3">// create a blog post</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">post</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">BlogPost</span><span class="hl-1">();</span><br/><br/><span class="hl-3">// create a comment</span><br/><span class="hl-7">post</span><span class="hl-1">.</span><span class="hl-7">comments</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">({ </span><span class="hl-7">title:</span><span class="hl-1"> </span><span class="hl-2">&#39;My comment&#39;</span><span class="hl-1"> });</span><br/><br/><span class="hl-7">post</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">(</span><span class="hl-4">function</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-6">if</span><span class="hl-1"> (!</span><span class="hl-7">err</span><span class="hl-1">) </span><span class="hl-7">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Success!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<p>The same goes for removing them:</p>
<pre><code class="language-js"><span class="hl-7">BlogPost</span><span class="hl-1">.</span><span class="hl-0">findById</span><span class="hl-1">(</span><span class="hl-7">myId</span><span class="hl-1">, </span><span class="hl-4">function</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">, </span><span class="hl-7">post</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-6">if</span><span class="hl-1"> (!</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-7">post</span><span class="hl-1">.</span><span class="hl-7">comments</span><span class="hl-1">[</span><span class="hl-8">0</span><span class="hl-1">].</span><span class="hl-0">remove</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-7">post</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">(</span><span class="hl-4">function</span><span class="hl-1"> (</span><span class="hl-7">err</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-3">// do something</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<p>Embedded documents enjoy all the same features as your models. Defaults, validators, middleware. Whenever an error occurs, it&#39;s bubbled to the <code>save()</code> error callback, so error handling is a snap!</p>
<a id="md:middleware" class="tsd-anchor"></a><h3><a href="#md:middleware">Middleware</a></h3><p>See the <a href="http://mongoosejs.com/docs/middleware.html">docs</a> page.</p>
<a id="md:intercepting-and-mutating-method-arguments" class="tsd-anchor"></a><h4><a href="#md:intercepting-and-mutating-method-arguments">Intercepting and mutating method arguments</a></h4><p>You can intercept method arguments via middleware.</p>
<p>For example, this would allow you to broadcast changes about your Documents every time someone <code>set</code>s a path in your Document to a new value:</p>
<pre><code class="language-js"><span class="hl-7">schema</span><span class="hl-1">.</span><span class="hl-0">pre</span><span class="hl-1">(</span><span class="hl-2">&#39;set&#39;</span><span class="hl-1">, </span><span class="hl-4">function</span><span class="hl-1"> (</span><span class="hl-7">next</span><span class="hl-1">, </span><span class="hl-7">path</span><span class="hl-1">, </span><span class="hl-7">val</span><span class="hl-1">, </span><span class="hl-7">typel</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">// `this` is the current Document</span><br/><span class="hl-1">  </span><span class="hl-4">this</span><span class="hl-1">.</span><span class="hl-0">emit</span><span class="hl-1">(</span><span class="hl-2">&#39;set&#39;</span><span class="hl-1">, </span><span class="hl-7">path</span><span class="hl-1">, </span><span class="hl-7">val</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// Pass control to the next pre</span><br/><span class="hl-1">  </span><span class="hl-0">next</span><span class="hl-1">();</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<p>Moreover, you can mutate the incoming <code>method</code> arguments so that subsequent middleware see different values for those arguments. To do so, just pass the new values to <code>next</code>:</p>
<pre><code class="language-js"><span class="hl-1">.</span><span class="hl-0">pre</span><span class="hl-1">(</span><span class="hl-7">method</span><span class="hl-1">, </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-0">firstPre</span><span class="hl-1"> (</span><span class="hl-7">next</span><span class="hl-1">, </span><span class="hl-7">methodArg1</span><span class="hl-1">, </span><span class="hl-7">methodArg2</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-3">// Mutate methodArg1</span><br/><span class="hl-1">  </span><span class="hl-0">next</span><span class="hl-1">(</span><span class="hl-2">&quot;altered-&quot;</span><span class="hl-1"> + </span><span class="hl-7">methodArg1</span><span class="hl-1">.</span><span class="hl-0">toString</span><span class="hl-1">(), </span><span class="hl-7">methodArg2</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-3">// pre declaration is chainable</span><br/><span class="hl-1">.</span><span class="hl-0">pre</span><span class="hl-1">(</span><span class="hl-7">method</span><span class="hl-1">, </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-0">secondPre</span><span class="hl-1"> (</span><span class="hl-7">next</span><span class="hl-1">, </span><span class="hl-7">methodArg1</span><span class="hl-1">, </span><span class="hl-7">methodArg2</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-7">methodArg1</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-3">// =&gt; &#39;altered-originalValOfMethodArg1&#39;</span><br/><br/><span class="hl-1">  </span><span class="hl-7">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-7">methodArg2</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-3">// =&gt; &#39;originalValOfMethodArg2&#39;</span><br/><br/><span class="hl-1">  </span><span class="hl-3">// Passing no arguments to `next` automatically passes along the current argument values</span><br/><span class="hl-1">  </span><span class="hl-3">// i.e., the following `next()` is equivalent to `next(methodArg1, methodArg2)`</span><br/><span class="hl-1">  </span><span class="hl-3">// and also equivalent to, with the example method arg</span><br/><span class="hl-1">  </span><span class="hl-3">// values, `next(&#39;altered-originalValOfMethodArg1&#39;, &#39;originalValOfMethodArg2&#39;)`</span><br/><span class="hl-1">  </span><span class="hl-0">next</span><span class="hl-1">();</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<a id="md:schema-gotcha" class="tsd-anchor"></a><h4><a href="#md:schema-gotcha">Schema gotcha</a></h4><p><code>type</code>, when used in a schema has special meaning within Orcoos. If your schema requires using <code>type</code> as a nested property you must use object notation:</p>
<pre><code class="language-js"><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">Schema</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-7">broken:</span><span class="hl-1"> { </span><span class="hl-7">type:</span><span class="hl-1"> </span><span class="hl-7">Boolean</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-7">asset:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">name:</span><span class="hl-1"> </span><span class="hl-7">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">type:</span><span class="hl-1"> </span><span class="hl-7">String</span><span class="hl-1"> </span><span class="hl-3">// uh oh, it broke. asset will be interpreted as String</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">Schema</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-7">works:</span><span class="hl-1"> { </span><span class="hl-7">type:</span><span class="hl-1"> </span><span class="hl-7">Boolean</span><span class="hl-1"> },</span><br/><span class="hl-1">  </span><span class="hl-7">asset:</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-7">name:</span><span class="hl-1"> </span><span class="hl-7">String</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-7">type:</span><span class="hl-1"> { </span><span class="hl-7">type:</span><span class="hl-1"> </span><span class="hl-7">String</span><span class="hl-1"> } </span><span class="hl-3">// works. asset is an object with a type property</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">});</span>
</code><button>Copy</button></pre>
<a id="md:driver-access" class="tsd-anchor"></a><h3><a href="#md:driver-access">Driver Access</a></h3><p>Orcoos is built on top of the <a href="https://github.com/oracle/nosql-node-sdk">Oracle NoSQL DB NodeJs SDK</a>. Each mongoose model keeps a reference to a <a href="https://oracle.github.io/nosql-node-sdk/pages/tables.html">native Oracle NoSQL DB SDK table</a>. The table object can be accessed using <code>YourModel.collection</code>. However, using the collection object directly bypasses all orcoos features, including hooks, validation, etc. The one
notable exception that <code>YourModel.collection</code> still buffers
commands. As such, <code>YourModel.collection.find()</code> will <strong>not</strong>
return a cursor.</p>
<a id="md:api-docs" class="tsd-anchor"></a><h2><a href="#md:api-docs">API Docs</a></h2><p>Find the API docs <a href="http://mongoosejs.com/docs/api/mongoose.html">here</a>.</p>
<a id="md:related-projects" class="tsd-anchor"></a><h2><a href="#md:related-projects">Related Projects</a></h2><a id="md:node-sdk-for-oracle-nosql-db" class="tsd-anchor"></a><h4><a href="#md:node-sdk-for-oracle-nosql-db">Node SDK for Oracle NoSQL DB</a></h4><ul>
<li><a href="https://github.com/oracle/nosql-node-sdk/">nosql-node-sdk</a></li>
</ul>
<a id="md:license" class="tsd-anchor"></a><h2><a href="#md:license">License</a></h2><p>Copyright (c) 2010 LearnBoost &lt;<a href="mailto:dev@learnboost.com">dev@learnboost.com</a>&gt;</p>
<p>Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
&#39;Software&#39;), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:</p>
<p>The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED &#39;AS IS&#39;, WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:orcoos"><span>Orcoos</span></a><ul><li><a href="#md:documentation"><span>Documentation</span></a></li><li><a href="#md:dev-instalation"><span>Dev instalation</span></a></li><li><a href="#md:installation"><span>Installation</span></a></li><li><a href="#md:importing"><span>Importing</span></a></li><li><a href="#md:overview"><span>Overview</span></a></li><li><ul><li><a href="#md:connecting-to-oracle-nosql-db"><span>Connecting to <wbr/>Oracle <wbr/>NoSQL DB</span></a></li><li><a href="#md:defining-a-model"><span>Defining a <wbr/>Model</span></a></li><li><a href="#md:accessing-a-model"><span>Accessing a <wbr/>Model</span></a></li><li><a href="#md:embedded-documents"><span>Embedded <wbr/>Documents</span></a></li><li><a href="#md:middleware"><span>Middleware</span></a></li><li><ul><li><a href="#md:intercepting-and-mutating-method-arguments"><span>Intercepting and mutating method arguments</span></a></li><li><a href="#md:schema-gotcha"><span>Schema gotcha</span></a></li></ul></li><li><a href="#md:driver-access"><span>Driver <wbr/>Access</span></a></li></ul></li><li><a href="#md:api-docs"><span>API <wbr/>Docs</span></a></li><li><a href="#md:related-projects"><span>Related <wbr/>Projects</span></a></li><li><ul><li><ul><li><a href="#md:node-sdk-for-oracle-nosql-db"><span>Node SDK for <wbr/>Oracle <wbr/>NoSQL DB</span></a></li></ul></li></ul></li><li><a href="#md:license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>Oracle NoSQL Database Orcoos SDK - v0.0.1</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>